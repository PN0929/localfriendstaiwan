<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é«”é©—è©³æƒ… - Local Friends Taiwan | å°ç£åœ¨åœ°é€£ç·š</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Microsoft JhengHei",sans-serif;line-height:1.6;color:#2D6A4F;background:#F7F5F2}

    /* æµ®å‹•å°è¦½åˆ— */
    .floating-nav{position:fixed;left:20px;top:50%;transform:translateY(-50%);z-index:1000;background:#fff;padding:1rem;border-radius:30px;box-shadow:0 4px 20px rgba(45,106,79,.2);border:2px solid #2D6A4F}
    .floating-nav a{display:block;width:50px;height:50px;margin:.5rem 0;border-radius:50%;background:linear-gradient(135deg,#2D6A4F,#40916C);color:#fff;text-decoration:none;display:flex;align-items:center;justify-content:center;font-size:1.5rem;transition:.3s}
    .floating-nav a:hover{transform:scale(1.1);background:linear-gradient(135deg,#40916C,#52B788)}

    /* å›é ‚ */
    .back-to-top{position:fixed;right:30px;bottom:30px;width:60px;height:60px;background:linear-gradient(135deg,#F4845F,#F4A261);color:#fff;border:none;border-radius:50%;font-size:1.5rem;cursor:pointer;box-shadow:0 4px 20px rgba(244,132,95,.4);display:none;z-index:999;transition:.3s}
    .back-to-top:hover{transform:translateY(-5px)}
    .back-to-top.show{display:flex;align-items:center;justify-content:center}

    /* Heroï¼šç¸®å°é«˜åº¦ã€ä¿ç•™é®ç½©èˆ‡åŸå§‹æ¯”ä¾‹ */
    .hero-section{position:relative;height:42vh;min-height:220px;max-height:460px;display:flex;align-items:center;justify-content:center;text-align:center;overflow:hidden;background:#2D6A4F}
    .hero-overlay{position:absolute;inset:0;background:rgba(45,106,79,.6);z-index:2}
    .hero-content{position:relative;z-index:3;color:#fff;max-width:1000px;padding:1.25rem 2rem}
    .hero-content h1{font-size:2.4rem;font-weight:800;margin-bottom:.4rem;text-shadow:2px 2px 8px rgba(0,0,0,.3);line-height:1.2}
    .hero-content .subtitle{font-size:1.3rem;margin-bottom:.8rem;opacity:.95;text-shadow:1px 1px 4px rgba(0,0,0,.3)}
    .hero-content .description{font-size:1.1rem;margin-bottom:1.2rem;line-height:1.7;opacity:.9;text-shadow:1px 1px 4px rgba(0,0,0,.3)}
    .hero-tags{display:flex;gap:.6rem;justify-content:center;flex-wrap:wrap}
    .hero-tag{padding:.6rem 1.1rem;background:rgba(255,255,255,.2);backdrop-filter:blur(10px);border:2px solid rgba(255,255,255,.3);border-radius:30px;color:#fff;font-size:.95rem;font-weight:600}
    .hero-status{padding:.6rem 1.1rem;background:linear-gradient(135deg,#F4845F,#F4A261);border:2px solid rgba(255,255,255,.5);border-radius:30px;color:#fff;font-size:.95rem;font-weight:700;box-shadow:0 4px 15px rgba(244,132,95,.4)}

    /* å½±åƒèƒŒæ™¯ï¼šæ¡Œæ©Ÿä¸‰å¼µä¸¦æ’ã€ä¸è¼ªæ’­ */
    .hero-media{position:absolute;inset:0;z-index:1}
    .hero-grid{width:100%;height:100%;display:grid;grid-template-columns:repeat(3,1fr);gap:0}
    .hero-grid-item{position:relative;background:linear-gradient(135deg,#2D6A4F,#40916C)}
    .hero-grid-item img{width:100%;height:100%;object-fit:contain;display:block}

    /* æ‰‹æ©Ÿï¼šå–®å¼µè¼ªæ’­ */
    .hero-carousel{display:none;position:absolute;inset:0}
    .hero-slide{position:absolute;inset:0;opacity:0;transition:opacity 0.6s ease;background:linear-gradient(135deg,#2D6A4F,#40916C)}
    .hero-slide.active{opacity:1}
    .hero-slide img{width:100%;height:100%;object-fit:contain;display:block;background:transparent}

    /* å…§å®¹èˆ‡å¡ç‰‡ */
    .container{max-width:1200px;margin:0 auto;padding:3rem 2rem}
    .content-section{background:#fff;padding:3rem;border-radius:15px;margin-bottom:2rem;border:3px solid #E9C46A;box-shadow:0 4px 20px rgba(233,196,106,.2)}
    .content-section h2{font-size:2rem;color:#2D6A4F;margin-bottom:1.2rem;font-weight:800;border-bottom:3px solid #E9C46A;padding-bottom:.5rem}
    .content-section h3{font-size:1.5rem;color:#2D6A4F;margin:2rem 0 1rem;font-weight:700}
    .content-section p{font-size:1.2rem;color:#555;line-height:1.9;margin-bottom:1.2rem}
    .info-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:2rem;margin-top:1.2rem}
    .info-item{background:#F7F5F2;padding:1.6rem;border-radius:12px;border:2px solid #E9C46A}
    .info-item h4{font-size:1.2rem;color:#2D6A4F;margin-bottom:.8rem;font-weight:800}
    .info-item p{font-size:1.05rem;margin-bottom:.4rem}
    .info-item a{color:#F4845F;text-decoration:none;font-weight:700;word-break:break-all}
    .info-item a:hover{text-decoration:underline}

    /* ç›´æ¥æ¸²æŸ“çš„ Google Doc å€å¡Š */
    .doc-render{background:#fff;border-radius:12px;box-shadow:0 4px 20px rgba(45,106,79,.12);padding:0}
    .doc-render-inner{padding:1.25rem}
    .doc-render .loading-line{height:10px;border-radius:6px;background:linear-gradient(90deg,#e9f3ee,#f3faf7,#e9f3ee);background-size:200% 100%;animation:shimmer 1.2s infinite}
    @keyframes shimmer{0%{background-position:0 0}100%{background-position:200% 0}}

    /* åœ°åœ– */
    .map-section{background:#fff;padding:2rem;border-radius:15px;border:3px solid #E9C46A;box-shadow:0 4px 20px rgba(233,196,106,.2);margin-bottom:2rem}
    .map-section h2{font-size:2rem;color:#2D6A4F;margin-bottom:1rem;font-weight:800}
    .map-address{font-size:1.1rem;color:#555;margin-bottom:1.2rem;padding:.9rem 1rem;background:#F7F5F2;border-radius:8px;border-left:4px solid #E9C46A}
    .map-container{width:100%;height:450px;border-radius:12px;overflow:hidden;box-shadow:0 4px 15px rgba(45,106,79,.15)}
    .map-container iframe{width:100%;height:100%;border:0}

    .cta-section{background:linear-gradient(135deg,#2D6A4F,#40916C);color:#fff;padding:3rem;border-radius:15px;text-align:center;box-shadow:0 4px 20px rgba(45,106,79,.3)}
    .cta-section h2{font-size:2.2rem;margin-bottom:1rem;font-weight:800}
    .cta-section p{font-size:1.2rem;margin-bottom:2rem;opacity:.95}
    .btn{display:inline-block;padding:1.1rem 2.5rem;background:linear-gradient(135deg,#F4845F,#F4A261);color:#fff;text-decoration:none;border-radius:50px;font-weight:800;font-size:1.1rem;transition:.3s;box-shadow:0 4px 15px rgba(244,132,95,.4)}
    .btn:hover{transform:translateY(-3px);box-shadow:0 6px 25px rgba(244,132,95,.6)}

    .footer{background:linear-gradient(135deg,#2D6A4F,#40916C);color:#fff;text-align:center;padding:2rem}
    .loading{text-align:center;padding:5rem 2rem;font-size:1.4rem;color:#2D6A4F;font-weight:800}

    /* æ‰‹æ©Ÿï¼šé¡¯ç¤ºè¼ªæ’­ã€éš±è—ä¸‰åœ–æ’ç‰ˆ */
    @media (max-width:768px){
      .floating-nav{left:10px;padding:.5rem}
      .floating-nav a{width:40px;height:40px;font-size:1.2rem;margin:.3rem 0}
      .hero-section{height:34vh;min-height:200px}
      .hero-content h1{font-size:1.8rem}
      .hero-content .subtitle{font-size:1.1rem}
      .hero-content .description{font-size:.95rem}
      .hero-grid{display:none}
      .hero-carousel{display:block}
      .container{padding:2rem 1rem}
      .content-section{padding:2rem 1.4rem}
      .content-section h2{font-size:1.6rem}
      .info-grid{grid-template-columns:1fr}
      .map-container{height:300px}
    }
  </style>
</head>
<body>
  <!-- æµ®å‹•å°è¦½ -->
  <nav class="floating-nav">
    <a href="index.html" title="é¦–é ">ğŸ </a>
    <a href="experiences.html" title="é«”é©—åˆ—è¡¨">ğŸŒŸ</a>
    <a href="index.html#about" title="é—œæ–¼">â„¹ï¸</a>
    <a href="index.html#contact" title="è¯çµ¡">âœ‰ï¸</a>
  </nav>

  <button class="back-to-top" onclick="scrollToTop()">â†‘</button>

  <div id="loading" class="loading">è¼‰å…¥é«”é©—è³‡è¨Šä¸­... Loading experience details...</div>

  <div id="content" style="display:none;">
    <!-- Hero -->
    <section class="hero-section" id="heroSection">
      <div class="hero-media">
        <!-- æ¡Œæ©Ÿï¼šä¸‰å¼µä¸¦æ’ -->
        <div class="hero-grid" id="heroGrid"></div>
        <!-- æ‰‹æ©Ÿï¼šå–®å¼µè¼ªæ’­ -->
        <div class="hero-carousel" id="heroCarousel"></div>
      </div>
      <div class="hero-overlay"></div>
      <div class="hero-content" id="heroContent"></div>
    </section>

    <div class="container">
      <!-- è©³ç´°èªªæ˜ï¼ˆç›´æ¥æ‹‰å– Google Doc å…§å®¹æ¸²æŸ“ï¼‰ -->
      <div class="content-section doc-render" id="detailSection">
        <h2>ğŸ“– è©³ç´°èªªæ˜ Details</h2>
        <div class="doc-render-inner" id="docRenderInner">
          <div class="loading-line" style="margin:12px 0;width:60%"></div>
          <div class="loading-line" style="margin:12px 0;width:80%"></div>
          <div class="loading-line" style="margin:12px 0;width:40%"></div>
        </div>
      </div>

      <!-- è¯çµ¡è³‡è¨Š -->
      <div class="content-section" id="contactSection"></div>

      <!-- åœ°åœ– -->
      <div class="map-section" id="mapSection"></div>

      <!-- CTA -->
      <div class="cta-section">
        <h2>æº–å‚™å¥½é–‹å§‹ä½ çš„é«”é©—äº†å—ï¼Ÿ</h2>
        <h2>Ready to Start Your Experience?</h2>
        <p>ç›´æ¥è¯ç¹«ä¸»è¾¦å–®ä½å®‰æ’ä½ çš„å°ˆå±¬é«”é©—<br>Contact the organizer to arrange your unique experience</p>
        <a href="experiences.html" class="btn">â† ç€è¦½æ›´å¤šé«”é©— Browse More Experiences</a>
      </div>
    </div>
  </div>

  <footer class="footer">
    <p><strong>Local Friends Taiwan å°ç£åœ¨åœ°é€£ç·š</strong></p>
    <p style="margin-top:1rem;opacity:.9">Your local friend in Taiwan | ä½ åœ¨å°ç£çš„åœ¨åœ°æœ‹å‹</p>
  </footer>

  <script>
    const SHEET_ID  = '1GD4gg3sGIfX7KGrJkYCL10wzvwZh5FMWQPGd9NVTQyc';
    const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

    // ä½ çš„å…¬é–‹ Docï¼ˆå‚™æ´ï¼‰
    const FALLBACK_DOC_URL = 'https://docs.google.com/document/d/e/2PACX-1vQj1gYlRDbgpH-IupwfkeS8kSMIvGb9TadFFwGpzj9TJXLYv3kzvhu9BqcpUetG-y7Dpt2M8qJLFkoV/pub';

    let currentSlide = 0;
    let slideTimer = null;
    let carouselLinks = [];

    async function loadExperience(){
      const id = new URLSearchParams(window.location.search).get('id');
      if(!id){
        document.getElementById('loading').innerHTML = `
          <p>æ‰¾ä¸åˆ°é«”é©— ID Experience ID not found</p>
          <p style="margin-top:1rem;"><a href="experiences.html" style="color:#F4845F;font-weight:700;">â† è¿”å›é«”é©—åˆ—è¡¨ Back to Experiences</a></p>`;
        return;
      }
      try{
        const txt = await (await fetch(SHEET_URL)).text();
        const rows = parseCSV(txt);
        const headers = rows[0];
        const data = rows.slice(1);
        const exp = data.map(r=>{
          const o={}; headers.forEach((h,i)=>o[h]=r[i]||''); return o;
        }).find(o=>(o['ID']||'').toLowerCase()===id.toLowerCase());
        if(!exp){
          document.getElementById('loading').innerHTML = `
            <p>æ‰¾ä¸åˆ°æ­¤é«”é©— Experience not found</p>
            <p style="margin-top:1rem;"><a href="experiences.html" style="color:#F4845F;font-weight:700;">â† è¿”å›é«”é©—åˆ—è¡¨ Back to Experiences</a></p>`;
          return;
        }
        renderPage(exp);
      }catch(err){
        console.error(err);
        document.getElementById('loading').textContent='âš ï¸ ç„¡æ³•è¼‰å…¥è³‡æ–™ Error loading data';
      }
    }

    function parseCSV(csv){
      const lines = csv.split('\n');
      return lines.map(line=>{
        const values=[]; let cur=''; let inQ=false;
        for(const ch of line){
          if(ch==='"') inQ=!inQ;
          else if(ch===',' && !inQ){ values.push(cur.trim()); cur=''; }
          else cur+=ch;
        }
        values.push(cur.trim());
        return values;
      });
    }

    function renderPage(exp){
      document.getElementById('loading').style.display='none';
      document.getElementById('content').style.display='block';
      document.title = `${exp['é«”é©—åç¨±(ä¸­)']} - Local Friends Taiwan | å°ç£åœ¨åœ°é€£ç·š`;

      renderHero(exp);
      renderDetailFromDoc(exp);
      renderContact(exp);
      renderMap(exp);
    }

    /* ---------------- é¡¶éƒ¨åœ–ç‰‡ï¼šæ¡Œæ©Ÿä¸‰å¼µä¸¦æ’ / æ‰‹æ©Ÿå–®å¼µè¼ªæ’­ ---------------- */
    function getPhotoLinks(exp){
      // æ”¯æ´ï¼šç…§ç‰‡é›† / å°é¢åœ–é€£çµ / åœ–ç‰‡ï¼›åˆ†éš”æ”¯æ´ , ï¼Œ \n ç©ºç™½
      const raw = (exp['ç…§ç‰‡é›†'] || exp['å°é¢åœ–é€£çµ'] || exp['åœ–ç‰‡'] || '').replace(/ï¼Œ/g, ',');
      return raw.split(/[,\s]+/).map(s=>s.trim()).filter(Boolean);
    }

    function renderHero(exp){
      const grid = document.getElementById('heroGrid');
      const carousel = document.getElementById('heroCarousel');
      const links = getPhotoLinks(exp);

      // æ¡Œæ©Ÿï¼šä¸‰å¼µä¸¦æ’ï¼ˆå–å‰ä¸‰å¼µï¼Œä¸è¼ªæ’­ï¼‰
      grid.innerHTML = (links.length ? links.slice(0,3) : [null,null,null]).map((url,i)=>`
        <div class="hero-grid-item">
          ${url ? `<img src="${url}" alt="hero ${i+1}" onerror="this.style.display='none'">`
                : `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#fff;opacity:.9">ğŸ“·</div>`}
        </div>`).join('');

      // æ‰‹æ©Ÿï¼šå–®å¼µè¼ªæ’­
      carouselLinks = links.length? links : [];
      carousel.innerHTML = carouselLinks.length ? carouselLinks.map((url,i)=>`
        <div class="hero-slide ${i===0?'active':''}">
          <img src="${url}" alt="slide ${i+1}" onerror="this.parentElement.innerHTML='<div style=&quot;width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#fff;opacity:.9&quot;>ğŸ“·</div>'">
        </div>`).join('') : `<div class="hero-slide active"></div>`;

      // å•Ÿç”¨æ‰‹æ©Ÿè¼ªæ’­ï¼ˆæ¡Œæ©Ÿä¸æœƒçœ‹åˆ° carouselï¼‰
      startMobileCarousel();

      // æ–‡å­—å€
      const heroContent = document.getElementById('heroContent');
      heroContent.innerHTML = `
        <h1>${exp['é«”é©—åç¨±(ä¸­)']||''}</h1>
        ${exp['é«”é©—åç¨±(è‹±)']?`<div class="subtitle">${exp['é«”é©—åç¨±(è‹±)']}</div>`:''}
        <div class="description">${exp['ä¸€å¥è©±æè¿°(ä¸­)']||''}</div>
        <div class="hero-tags">
          ${exp['åœ°å€']?`<span class="hero-tag">ğŸ“ ${exp['åœ°å€']}</span>`:''}
          ${exp['ä¸»è¦åˆ†é¡']?`<span class="hero-tag">${exp['ä¸»è¦åˆ†é¡']}</span>`:''}
          ${exp['é›£åº¦']?`<span class="hero-tag">â­ é›£åº¦: ${exp['é›£åº¦']}</span>`:''}
          <span class="hero-status">ğŸš§ ${exp['Status']||'æº–å‚™ä¸­'}</span>
        </div>`;
    }

    function startMobileCarousel(){
      clearInterval(slideTimer);
      currentSlide = 0;
      const slides = document.querySelectorAll('#heroCarousel .hero-slide');
      if(slides.length<=1) return;
      // è‡ªå‹•æ’­æ”¾ï¼ˆåªå½±éŸ¿æ‰‹æ©Ÿè¦–çª—ï¼›CSS æ§åˆ¶é¡¯ç¤ºï¼‰
      slideTimer = setInterval(()=>{
        slides[currentSlide].classList.remove('active');
        currentSlide = (currentSlide+1)%slides.length;
        slides[currentSlide].classList.add('active');
      }, 5000);

      // æ‰‹å‹¢æ»‘å‹•
      const el = document.getElementById('heroCarousel');
      let sx=0, ex=0;
      el.addEventListener('touchstart',e=>{sx=e.changedTouches[0].clientX},{passive:true});
      el.addEventListener('touchend',e=>{
        ex=e.changedTouches[0].clientX;
        const dx = ex - sx;
        if(Math.abs(dx)>40){
          const slides = document.querySelectorAll('#heroCarousel .hero-slide');
          slides[currentSlide].classList.remove('active');
          currentSlide = (currentSlide + (dx>0?-1:1) + slides.length) % slides.length;
          slides[currentSlide].classList.add('active');
          clearInterval(slideTimer);
          startMobileCarousel();
        }
      },{passive:true});
    }

    /* ---------------- è©³ç´°èªªæ˜ï¼šæ“·å– Google Docã€ç›´æ¥æ¸²æŸ“ ---------------- */
    async function renderDetailFromDoc(exp){
      const container = document.getElementById('docRenderInner');
      // å¯èƒ½çš„æ¬„ä½åï¼šè©³ç´°èªªæ˜é€£çµ / Google Doc / Google Doc é€£çµ
      const raw = (exp['è©³ç´°èªªæ˜é€£çµ'] || exp['Google Doc'] || exp['Google Doc é€£çµ'] || '').trim();
      const url = raw || FALLBACK_DOC_URL;

      // è©¦è‘—æŠŠä¸€èˆ¬ /document/d/{id}/edit è½‰ç‚º preview æˆ– export HTML
      const transformed = toFetchableDocURL(url);

      try{
        const resp = await fetch(transformed, {mode:'cors'});
        const html = await resp.text();

        // è§£æï¼šç›¡å¯èƒ½æ‹¿åˆ°ä¸»è¦å…§å®¹ï¼ˆpublished ç‰ˆæœ¬å¸¸è¦‹ #contentsï¼‰
        const tmp = document.createElement('div');
        tmp.innerHTML = html;

        let main = tmp.querySelector('#contents') || tmp.querySelector('body') || tmp;
        // ç§»é™¤ Google è‡ªå¸¶çš„å¤–å±¤å°èˆª/æ¨£å¼ï¼ˆç›¡åŠ›æ¸…ç†ï¼Œä¿å®ˆä¸éåº¦ï¼‰
        main.querySelectorAll('link,style,header,nav').forEach(n=>n.remove());

        container.innerHTML = '';
        // åŒ…ä¸€å±¤ï¼Œè®“åœ–ç‰‡/è¡¨æ ¼åœ¨æˆ‘å€‘çš„å¡ç‰‡å…§è‡ªé©æ‡‰
        const wrapper = document.createElement('div');
        wrapper.style.wordBreak = 'break-word';
        wrapper.style.lineHeight = '1.8';
        wrapper.style.color = '#2e2e2e';
        wrapper.style.fontSize = '1.05rem';
        // è®“åœ–ç‰‡ä¸è¶…å‡º
        wrapper.querySelectorAll?.('img').forEach(img=>{ img.style.maxWidth='100%'; img.style.height='auto'; });
        wrapper.innerHTML = main.innerHTML;
        container.appendChild(wrapper);
      }catch(err){
        console.warn('Doc fetch blocked (CORS). Fallback to iframe.', err);
        // CORS è¢«æ“‹ï¼Œé€€å›æ¥µç°¡ iframeï¼ˆç„¡é‚Šæ¡†ã€å’ŒèƒŒæ™¯ä¸€è‡´ï¼‰
        container.innerHTML = `
          <iframe src="${toEmbeddableIframeURL(url)}"
                  style="width:100%;height:900px;border:0;border-radius:12px;background:#fff"
                  loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>`;
      }
    }

    function toFetchableDocURL(url){
      // å·²ç™¼ä½ˆåˆ°ç¶²è·¯ï¼š/document/d/e/.../pub
      if(/\/document\/d\/e\/[^/]+\/pub/.test(url)){
        // ç›´æ¥å– pubï¼ˆHTMLï¼‰ï¼Œå¯è¢«æŠ“å–
        return url.includes('?') ? url : url + '?embedded=true';
      }
      // ä¸€èˆ¬ /document/d/{id}/edit â†’ å˜—è©¦ export htmlï¼ˆå¸¸è¦‹éœ€å…¬é–‹å¯è®€æ‰è¡Œï¼‰
      const m = url.match(/\/document\/d\/([^/]+)/);
      if(m){
        const id = m[1];
        // å…ˆè©¦ export html
        return `https://docs.google.com/document/d/${id}/export?format=html`;
      }
      // å…¶ä»–æœªçŸ¥æƒ…æ³ï¼šåŸæ¨£ï¼ˆå¯èƒ½æœƒè¢«æ“‹ï¼Œäº¤ç”± try/catch è™•ç†ï¼‰
      return url;
    }

    function toEmbeddableIframeURL(url){
      if(/\/document\/d\/e\/[^/]+\/pub/.test(url)){
        return url.includes('?') ? url+'&embedded=true' : url+'?embedded=true';
      }
      const m = url.match(/\/document\/d\/([^/]+)/);
      if(m){
        const id = m[1];
        return `https://docs.google.com/document/d/${id}/preview?rm=minimal&embedded=true`;
      }
      return url;
    }

    /* ---------------- è¯çµ¡è³‡è¨Š ---------------- */
    function renderContact(exp){
      const box = document.getElementById('contactSection');
      let html = '<h2>ğŸ“ è¯çµ¡è³‡è¨Š Contact Information</h2><div class="info-grid">';
      let has = false;
      if(exp['ä¸»è¾¦å–®ä½']){ html+=`<div class="info-item"><h4>ğŸ¢ ä¸»è¾¦å–®ä½ Organizer</h4><p>${exp['ä¸»è¾¦å–®ä½']}</p></div>`; has=true; }
      if(exp['è¯çµ¡äºº']){ html+=`<div class="info-item"><h4>ğŸ‘¤ è¯çµ¡äºº Contact Person</h4><p>${exp['è¯çµ¡äºº']}</p></div>`; has=true; }
      if(exp['é›»è©±']){ html+=`<div class="info-item"><h4>ğŸ“± é›»è©± Phone</h4><p><a href="tel:${exp['é›»è©±']}">${exp['é›»è©±']}</a></p></div>`; has=true; }
      if(exp['Email']){ html+=`<div class="info-item"><h4>âœ‰ï¸ Email</h4><p><a href="mailto:${exp['Email']}">${exp['Email']}</a></p></div>`; has=true; }
      if(exp['ç¶²ç«™']){ html+=`<div class="info-item"><h4>ğŸŒ ç¶²ç«™ Website</h4><p><a href="${exp['ç¶²ç«™']}" target="_blank">${exp['ç¶²ç«™']}</a></p></div>`; has=true; }
      if(exp['ç¤¾ç¾¤åª’é«”']){ html+=`<div class="info-item"><h4>ğŸ“± ç¤¾ç¾¤åª’é«” Social Media</h4><p><a href="${exp['ç¤¾ç¾¤åª’é«”']}" target="_blank">${exp['ç¤¾ç¾¤åª’é«”']}</a></p></div>`; has=true; }
      html+='</div>';
      if(has) box.innerHTML = html; else box.style.display='none';
    }

    /* ---------------- åœ°åœ–ï¼šç”¨åœ°å€å®šä½ ---------------- */
    function renderMap(exp){
      const box = document.getElementById('mapSection');
      const addr = (exp['åœ°å€']||'').trim();
      if(!addr){ box.style.display='none'; return; }
      const src = `https://www.google.com/maps?q=${encodeURIComponent(addr)}&output=embed`;
      box.innerHTML = `
        <h2>ğŸ“ ä½ç½®è³‡è¨Š Location</h2>
        <div class="map-address">ğŸ“ ${addr}</div>
        <div class="map-container"><iframe src="${src}" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>`;
    }

    function scrollToTop(){ window.scrollTo({top:0,behavior:'smooth'}) }
    window.addEventListener('scroll',()=>{
      const b=document.querySelector('.back-to-top');
      if(window.pageYOffset>300) b.classList.add('show'); else b.classList.remove('show');
    });

    window.addEventListener('DOMContentLoaded', loadExperience);
  </script>
</body>
</html>
