<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«”é©—è©³æƒ… - Local Friends Taiwan | å°ç£åœ¨åœ°é€£ç·š</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
            line-height: 1.6; color: #2D6A4F; background: #F7F5F2;
        }

        /* æµ®å‹•å°è¦½åˆ— */
        .floating-nav {
            position: fixed; left: 20px; top: 50%; transform: translateY(-50%);
            z-index: 1000; background: white; padding: 1rem; border-radius: 30px;
            box-shadow: 0 4px 20px rgba(45,106,79,.2); border: 2px solid #2D6A4F;
        }
        .floating-nav a{
            display:block;width:50px;height:50px;margin:.5rem 0;border-radius:50%;
            background:linear-gradient(135deg,#2D6A4F,#40916C);color:#fff;text-decoration:none;
            display:flex;align-items:center;justify-content:center;font-size:1.5rem;transition:.3s;
        }
        .floating-nav a:hover{ transform:scale(1.1); background:linear-gradient(135deg,#40916C,#52B788); }

        /* å›é ‚æŒ‰éˆ• */
        .back-to-top {
            position: fixed; right: 30px; bottom: 30px; width: 60px; height: 60px;
            background: linear-gradient(135deg,#F4845F,#F4A261); color:#fff; border:none; border-radius:50%;
            font-size:1.5rem; cursor:pointer; box-shadow:0 4px 20px rgba(244,132,95,.4);
            display:none; z-index:999; transition: transform .3s;
        }
        .back-to-top:hover{ transform: translateY(-5px); }
        .back-to-top.show{ display:flex;align-items:center;justify-content:center; }

        /* Hero Section - å…¨è¢å¹•ç…§ç‰‡èƒŒæ™¯ */
        .hero-section {
            position: relative; height: 100vh; display:flex; align-items:center; justify-content:center;
            text-align:center; overflow:hidden; background: #2D6A4F;
        }
        .hero-background { position:absolute; inset:0; z-index:1; }
        .hero-slide { position:absolute; inset:0; opacity:0; transition: opacity 1s ease; background: linear-gradient(135deg,#2D6A4F,#40916C); }
        .hero-slide.active { opacity:1; }
        /* âœ… 1. æ¯å¼µåœ–è‡ªå‹•é©æ‡‰åŸå§‹æ¯”ä¾‹ï¼ˆé¿å…è£åˆ‡ï¼‰ */
        .hero-slide img {
            width: 100%; height: 100%;
            object-fit: contain;            /* ä¿ç•™åŸå§‹æ¯”ä¾‹ */
            display: block;
            background: transparent;
        }
        /* âœ… 3. ç¶ è‰²é®ç½© rgba(45,106,79,0.6) */
        .hero-overlay { position:absolute; inset:0; background: rgba(45,106,79,0.6); z-index:2; }

        /* Hero å…§å®¹ */
        .hero-content {
            position: relative; z-index:3; color:#fff; max-width:1000px; padding:2rem; animation: fadeInUp 1s ease;
        }
        .hero-content h1 {
            font-size: 4rem; font-weight: bold; margin-bottom:1rem; text-shadow: 2px 2px 8px rgba(0,0,0,.3); line-height:1.2;
        }
        .hero-content .subtitle { font-size:2rem; margin-bottom:1.5rem; opacity:.95; text-shadow:1px 1px 4px rgba(0,0,0,.3); }
        .hero-content .description { font-size:1.5rem; margin-bottom:2.5rem; line-height:1.8; opacity:.9; text-shadow:1px 1px 4px rgba(0,0,0,.3); }
        .hero-tags{ display:flex; gap:1rem; justify-content:center; flex-wrap:wrap; margin-bottom:2rem; }
        .hero-tag{
            padding:1rem 2rem; background: rgba(255,255,255,.2); backdrop-filter: blur(10px);
            border:2px solid rgba(255,255,255,.3); border-radius:30px; color:#fff; font-size:1.2rem; font-weight:600;
            text-shadow:1px 1px 2px rgba(0,0,0,.3);
        }
        .hero-status{
            padding:1rem 2rem; background:linear-gradient(135deg,#F4845F,#F4A261);
            border:2px solid rgba(255,255,255,.5); border-radius:30px; color:#fff; font-size:1.2rem; font-weight:bold;
            box-shadow:0 4px 15px rgba(244,132,95,.4);
        }

        /* è¼ªæ’­æ§åˆ¶æŒ‰éˆ•ï¼ˆæ¡Œæ©Ÿé¡¯ç¤ºï¼Œæ‰‹æ©Ÿéš±è—ï¼‰ */
        .hero-controls{
            position:absolute; bottom:30px; left:50%; transform:translateX(-50%); display:flex; gap:1rem; z-index:4;
        }
        .hero-control-btn{
            width:50px; height:50px; background: rgba(255,255,255,.3); backdrop-filter: blur(10px);
            border:2px solid rgba(255,255,255,.5); border-radius:50%; color:#fff; font-size:1.5rem; cursor:pointer;
            transition:.3s; display:flex; align-items:center; justify-content:center;
        }
        .hero-control-btn:hover{ background: rgba(255,255,255,.5); transform: scale(1.1); }

        /* æ»¾å‹•æŒ‡ç¤ºå™¨ */
        .scroll-indicator{
            position:absolute; bottom:80px; left:50%; transform:translateX(-50%);
            color:#fff; font-size:2rem; cursor:pointer; animation:bounce 2s ease infinite; z-index:4;
        }

        /* å…§å®¹å€å¡Š */
        .container{ max-width:1200px; margin:0 auto; padding:3rem 2rem; }
        .content-section{
            background:#fff; padding:3rem; border-radius:15px; margin-bottom:2rem;
            border:3px solid #E9C46A; box-shadow:0 4px 20px rgba(233,196,106,.2);
        }
        .content-section h2{
            font-size:2rem; color:#2D6A4F; margin-bottom:1.5rem; font-weight:bold; border-bottom:3px solid #E9C46A; padding-bottom:.5rem;
        }
        .content-section h3{ font-size:1.5rem; color:#2D6A4F; margin:2rem 0 1rem; font-weight:bold; }
        .content-section p{ font-size:1.2rem; color:#555; line-height:1.9; margin-bottom:1.5rem; }

        .info-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:2rem; margin-top:2rem; }
        .info-item{ background:#F7F5F2; padding:2rem; border-radius:12px; border:2px solid #E9C46A; }
        .info-item h4{ font-size:1.3rem; color:#2D6A4F; margin-bottom:1rem; font-weight:bold; }
        .info-item p{ font-size:1.1rem; margin-bottom:.5rem; }
        .info-item a{ color:#F4845F; text-decoration:none; font-weight:600; word-break:break-all; }
        .info-item a:hover{ text-decoration:underline; }

        /* åœ°åœ–å€å¡Š */
        .map-section{
            background:#fff; padding:2rem; border-radius:15px; border:3px solid #E9C46A; box-shadow:0 4px 20px rgba(233,196,106,.2); margin-bottom:2rem;
        }
        .map-section h2{ font-size:2rem; color:#2D6A4F; margin-bottom:1rem; font-weight:bold; }
        .map-address{
            font-size:1.2rem; color:#555; margin-bottom:1.5rem; padding:1rem; background:#F7F5F2; border-radius:8px; border-left:4px solid #E9C46A;
        }
        .map-container{ width:100%; height:450px; border-radius:12px; overflow:hidden; box-shadow:0 4px 15px rgba(45,106,79,.15); }
        .map-container iframe{ width:100%; height:100%; border:none; }

        .cta-section{
            background:linear-gradient(135deg,#2D6A4F,#40916C); color:#fff; padding:3rem; border-radius:15px; text-align:center;
            box-shadow:0 4px 20px rgba(45,106,79,.3);
        }
        .cta-section h2{ font-size:2.2rem; margin-bottom:1rem; font-weight:bold; }
        .cta-section p{ font-size:1.3rem; margin-bottom:2rem; opacity:.95; }
        .btn{
            display:inline-block; padding:1.3rem 3rem; background:linear-gradient(135deg,#F4845F,#F4A261); color:#fff; text-decoration:none;
            border-radius:50px; font-weight:bold; font-size:1.2rem; transition:.3s; box-shadow:0 4px 15px rgba(244,132,95,.4);
        }
        .btn:hover{ transform: translateY(-3px); box-shadow:0 6px 25px rgba(244,132,95,.6); }

        .footer{ background:linear-gradient(135deg,#2D6A4F,#40916C); color:#fff; text-align:center; padding:2rem; }
        .loading{ text-align:center; padding:5rem 2rem; font-size:1.5rem; color:#2D6A4F; font-weight:bold; }

        /* å‹•ç•« */
        @keyframes fadeInUp{ from{opacity:0; transform:translateY(30px);} to{opacity:1; transform:translateY(0);} }
        @keyframes bounce{
            0%,20%,50%,80%,100%{ transform: translateX(-50%) translateY(0); }
            40%{ transform: translateX(-50%) translateY(-10px); }
            60%{ transform: translateX(-50%) translateY(-5px); }
        }

        /* æ‰‹æ©Ÿç‰ˆé©é… + âœ… 4. æ‰‹æ©Ÿä¸é¡¯ç¤ºæŒ‰éˆ•ã€å¯æ»‘å‹• */
        @media (max-width:768px){
            .floating-nav{ left:10px; padding:.5rem; }
            .floating-nav a{ width:40px; height:40px; font-size:1.2rem; margin:.3rem 0; }
            .hero-content h1{ font-size:2.5rem; }
            .hero-content .subtitle{ font-size:1.3rem; }
            .hero-content .description{ font-size:1.1rem; }
            .hero-tag,.hero-status{ font-size:1rem; padding:.8rem 1.5rem; }
            .container{ padding:2rem 1rem; }
            .content-section{ padding:2rem 1.5rem; }
            .content-section h2{ font-size:1.6rem; }
            .info-grid{ grid-template-columns:1fr; }
            .map-container{ height:300px; }
            .hero-controls{ display:none !important; } /* âœ… æ‰‹æ©Ÿéš±è—å·¦å³æŒ‰éˆ• */
        }
    </style>
</head>
<body>
    <!-- æµ®å‹•å°è¦½ -->
    <nav class="floating-nav">
        <a href="index.html" title="é¦–é ">ğŸ </a>
        <a href="experiences.html" title="é«”é©—åˆ—è¡¨">ğŸŒŸ</a>
        <a href="index.html#about" title="é—œæ–¼">â„¹ï¸</a>
        <a href="index.html#contact" title="è¯çµ¡">âœ‰ï¸</a>
    </nav>

    <!-- å›é ‚æŒ‰éˆ• -->
    <button class="back-to-top" onclick="scrollToTop()">â†‘</button>

    <div id="loading" class="loading">è¼‰å…¥é«”é©—è³‡è¨Šä¸­... Loading experience details...</div>

    <div id="content" style="display: none;">
        <!-- Hero Section - å…¨è¢å¹•ç…§ç‰‡èƒŒæ™¯ -->
        <section class="hero-section" id="heroSection">
            <div class="hero-background" id="heroBackground"><!-- ç…§ç‰‡è¼ªæ’­ --></div>
            <div class="hero-overlay"></div>
            <div class="hero-content" id="heroContent"><!-- æ–‡æ¡ˆå‹•æ…‹ç”Ÿæˆ --></div>

            <!-- æ¡Œæ©Ÿå·¦å³æ§åˆ¶ï¼ˆæ‰‹æ©Ÿéš±è—ï¼‰ -->
            <div class="hero-controls" id="heroControls" style="display: none;">
                <button class="hero-control-btn" onclick="changeSlide(-1)">â€¹</button>
                <button class="hero-control-btn" onclick="changeSlide(1)">â€º</button>
            </div>

            <div class="scroll-indicator" onclick="document.querySelector('.container').scrollIntoView({behavior:'smooth'})">â†“</div>
        </section>

        <div class="container">
            <!-- è©³ç´°èªªæ˜ -->
            <div class="content-section" id="detailSection"></div>

            <!-- è¯çµ¡è³‡è¨Š -->
            <div class="content-section" id="contactSection"></div>

            <!-- åœ°åœ– -->
            <div class="map-section" id="mapSection"></div>

            <!-- CTA -->
            <div class="cta-section">
                <h2>æº–å‚™å¥½é–‹å§‹ä½ çš„é«”é©—äº†å—ï¼Ÿ</h2>
                <h2>Ready to Start Your Experience?</h2>
                <p>ç›´æ¥è¯ç¹«ä¸»è¾¦å–®ä½å®‰æ’ä½ çš„å°ˆå±¬é«”é©—<br>Contact the organizer to arrange your unique experience</p>
                <a href="experiences.html" class="btn">â† ç€è¦½æ›´å¤šé«”é©— Browse More Experiences</a>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p><strong>Local Friends Taiwan å°ç£åœ¨åœ°é€£ç·š</strong></p>
        <p style="margin-top: 1rem; opacity: 0.9;">Your local friend in Taiwan | ä½ åœ¨å°ç£çš„åœ¨åœ°æœ‹å‹</p>
    </footer>

    <script>
        const SHEET_ID = '1GD4gg3sGIfX7KGrJkYCL10wzvwZh5FMWQPGd9NVTQyc';
        const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv`;

        let currentSlide = 0;
        let slideCount = 0;
        let slideInterval;
        let touchStartX = 0, touchEndX = 0;

        async function loadExperience() {
            const urlParams = new URLSearchParams(window.location.search);
            const experienceId = urlParams.get('id');

            if (!experienceId) {
                document.getElementById('loading').innerHTML = `
                    <p>æ‰¾ä¸åˆ°é«”é©— ID Experience ID not found</p>
                    <p style="margin-top: 1rem;"><a href="experiences.html" style="color: #F4845F; font-weight: bold;">â† è¿”å›é«”é©—åˆ—è¡¨ Back to Experiences</a></p>
                `;
                return;
            }

            try {
                const response = await fetch(SHEET_URL);
                const csvText = await response.text();
                const rows = parseCSV(csvText);
                const headers = rows[0];
                const data = rows.slice(1);

                const experience = data.map(row => {
                    const obj = {};
                    headers.forEach((header, index) => { obj[header] = row[index] || ''; });
                    return obj;
                }).find(exp => (exp['ID'] || '').toLowerCase() === experienceId.toLowerCase());

                if (!experience) {
                    document.getElementById('loading').innerHTML = `
                        <p>æ‰¾ä¸åˆ°æ­¤é«”é©— Experience not found</p>
                        <p style="margin-top: 1rem;"><a href="experiences.html" style="color: #F4845F; font-weight: bold;">â† è¿”å›é«”é©—åˆ—è¡¨ Back to Experiences</a></p>
                    `;
                    return;
                }

                displayExperience(experience);

            } catch (error) {
                console.error('è¼‰å…¥å¤±æ•—:', error);
                document.getElementById('loading').innerHTML = `
                    <p>è¼‰å…¥é«”é©—æ™‚ç™¼ç”ŸéŒ¯èª¤ Error loading experience</p>
                    <p style="margin-top: 1rem;"><a href="experiences.html" style="color: #F4845F; font-weight: bold;">â† è¿”å›é«”é©—åˆ—è¡¨ Back to Experiences</a></p>
                `;
            }
        }

        function parseCSV(csv) {
            const lines = csv.split('\n');
            return lines.map(line => {
                const values = [];
                let current = '';
                let inQuotes = false;

                for (let i = 0; i < line.length; i++) {
                    const char = line[i];
                    if (char === '"') inQuotes = !inQuotes;
                    else if (char === ',' && !inQuotes) { values.push(current.trim()); current = ''; }
                    else { current += char; }
                }
                values.push(current.trim());
                return values;
            });
        }

        function displayExperience(exp) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';

            document.title = `${exp['é«”é©—åç¨±(ä¸­)']} - Local Friends Taiwan | å°ç£åœ¨åœ°é€£ç·š`;

            // é¡¯ç¤º Hero Section
            displayHero(exp);

            // è©³ç´°èªªæ˜
            const detailSection = document.getElementById('detailSection');
            let detailHTML = '<h2>ğŸ“– è©³ç´°èªªæ˜ Details</h2>';

            if (exp['è©³ç´°èªªæ˜(ä¸­)']) detailHTML += formatContent(exp['è©³ç´°èªªæ˜(ä¸­)']);
            if (exp['è©³ç´°èªªæ˜(è‹±)']) detailHTML += `<h3>English Description:</h3>${formatContent(exp['è©³ç´°èªªæ˜(è‹±)'])}`;
            if (!exp['è©³ç´°èªªæ˜(ä¸­)'] && !exp['è©³ç´°èªªæ˜(è‹±)']) detailHTML += '<p>è©³ç´°è³‡è¨Šæº–å‚™ä¸­... Details coming soon...</p>';

            // è³‡è¨Šå¡ç‰‡
            let infoCards = '';
            if (exp['é©åˆå°è±¡']) infoCards += `<div class="info-item"><h4>ğŸ‘¥ é©åˆå°è±¡ Who Should Join</h4><p>${exp['é©åˆå°è±¡']}</p></div>`;
            if (exp['å»ºè­°åœç•™æ™‚é–“']) infoCards += `<div class="info-item"><h4>â° å»ºè­°åœç•™æ™‚é–“ Duration</h4><p>${exp['å»ºè­°åœç•™æ™‚é–“']}</p></div>`;
            if (exp['æœ€ä½³å­£ç¯€']) infoCards += `<div class="info-item"><h4>ğŸŒ¸ æœ€ä½³å­£ç¯€ Best Season</h4><p>${exp['æœ€ä½³å­£ç¯€']}</p></div>`;
            if (exp['åƒ¹æ ¼ç¯„åœ']) infoCards += `<div class="info-item"><h4>ğŸ’° åƒ¹æ ¼ç¯„åœ Price Range</h4><p>${exp['åƒ¹æ ¼ç¯„åœ']}</p></div>`;
            if (infoCards) detailHTML += `<div class="info-grid">${infoCards}</div>`;
            detailSection.innerHTML = detailHTML;

            // è¯çµ¡è³‡è¨Š
            const contactSection = document.getElementById('contactSection');
            let contactHTML = '<h2>ğŸ“ è¯çµ¡è³‡è¨Š Contact Information</h2><div class="info-grid">';
            let hasContact = false;

            if (exp['ä¸»è¾¦å–®ä½']) { contactHTML += `<div class="info-item"><h4>ğŸ¢ ä¸»è¾¦å–®ä½ Organizer</h4><p>${exp['ä¸»è¾¦å–®ä½']}</p></div>`; hasContact = true; }
            if (exp['è¯çµ¡äºº']) { contactHTML += `<div class="info-item"><h4>ğŸ‘¤ è¯çµ¡äºº Contact Person</h4><p>${exp['è¯çµ¡äºº']}</p></div>`; hasContact = true; }
            if (exp['é›»è©±']) { contactHTML += `<div class="info-item"><h4>ğŸ“± é›»è©± Phone</h4><p><a href="tel:${exp['é›»è©±']}">${exp['é›»è©±']}</a></p></div>`; hasContact = true; }
            if (exp['Email']) { contactHTML += `<div class="info-item"><h4>âœ‰ï¸ Email</h4><p><a href="mailto:${exp['Email']}">${exp['Email']}</a></p></div>`; hasContact = true; }
            if (exp['ç¶²ç«™']) { contactHTML += `<div class="info-item"><h4>ğŸŒ ç¶²ç«™ Website</h4><p><a href="${exp['ç¶²ç«™']}" target="_blank">${exp['ç¶²ç«™']}</a></p></div>`; hasContact = true; }
            if (exp['ç¤¾ç¾¤åª’é«”']) { contactHTML += `<div class="info-item"><h4>ğŸ“± ç¤¾ç¾¤åª’é«” Social Media</h4><p><a href="${exp['ç¤¾ç¾¤åª’é«”']}" target="_blank">${exp['ç¤¾ç¾¤åª’é«”']}</a></p></div>`; hasContact = true; }
            contactHTML += '</div>';
            if (hasContact) contactSection.innerHTML = contactHTML; else contactSection.style.display = 'none';

            // åœ°åœ–
            displayMap(exp);
        }

        function displayHero(exp) {
            const heroBackground = document.getElementById('heroBackground');
            const heroContent = document.getElementById('heroContent');
            const heroControls = document.getElementById('heroControls');

            // è®€å–ç…§ç‰‡ï¼ˆæœ€ä¸Šé¢ä¸‰å¼µç­‰ï¼‰ï¼šä¿ç•™åŸå§‹æ¯”ä¾‹
            let photoLinks = (exp['ç…§ç‰‡é›†'] || exp['å°é¢åœ–é€£çµ'] || '')
                .split(',').map(s => s.trim()).filter(Boolean);

            if (photoLinks.length > 0) {
                slideCount = photoLinks.length;
                heroBackground.innerHTML = photoLinks.map((link, idx) => `
                    <div class="hero-slide ${idx === 0 ? 'active' : ''}">
                        <img src="${link}" alt="${exp['é«”é©—åç¨±(ä¸­)'] || 'experience'} åœ–ç‰‡ ${idx+1}">
                    </div>
                `).join('');

                // æ¡Œæ©Ÿæ‰é¡¯ç¤ºæ§åˆ¶éˆ•ï¼›æ‰‹æ©Ÿä¸é¡¯ç¤ºï¼ˆCSS ä¹Ÿå·²éš±è—ï¼‰
                if (photoLinks.length > 1 && window.matchMedia('(min-width: 769px)').matches) {
                    heroControls.style.display = 'flex';
                } else {
                    heroControls.style.display = 'none';
                }

                startSlideShow(); // è‡ªå‹•è¼ªæ’­ï¼ˆæ¡Œæ©Ÿ/æ‰‹æ©Ÿçš†å¯ï¼Œä½†æ‰‹æ©Ÿæ²’æœ‰æŒ‰éˆ•ï¼‰
                bindTouchSwipe(); // âœ… æ‰‹æ©Ÿå¯æ»‘å‹•
            } else {
                // âœ… 5. æ²’ç…§ç‰‡ï¼šé¡¯ç¤ºå“ç‰Œæ¼¸å±¤èƒŒæ™¯ï¼ˆ.hero-slide èƒŒæ™¯å·²æ˜¯å“ç‰Œæ¼¸å±¤ï¼‰
                slideCount = 0;
                heroBackground.innerHTML = `
                    <div class="hero-slide active"></div>
                `;
                heroControls.style.display = 'none';
            }

            // Hero æ–‡æ¡ˆ
            heroContent.innerHTML = `
                <h1>${exp['é«”é©—åç¨±(ä¸­)'] || ''}</h1>
                ${exp['é«”é©—åç¨±(è‹±)'] ? `<div class="subtitle">${exp['é«”é©—åç¨±(è‹±)']}</div>` : ''}
                <div class="description">${exp['ä¸€å¥è©±æè¿°(ä¸­)'] || 'æ·±åº¦å°ç£åœ¨åœ°é«”é©—'}</div>
                <div class="hero-tags">
                    ${exp['åœ°å€'] ? `<span class="hero-tag">ğŸ“ ${exp['åœ°å€']}</span>` : ''}
                    ${exp['ä¸»è¦åˆ†é¡'] ? `<span class="hero-tag">${exp['ä¸»è¦åˆ†é¡']}</span>` : ''}
                    ${exp['é›£åº¦'] ? `<span class="hero-tag">â­ é›£åº¦: ${exp['é›£åº¦']}</span>` : ''}
                    <span class="hero-status">ğŸš§ ${exp['Status'] || 'æº–å‚™ä¸­'}</span>
                </div>
            `;
        }

        function startSlideShow() {
            clearInterval(slideInterval);
            if (slideCount <= 1) return;
            slideInterval = setInterval(() => changeSlide(1), 5000);
        }

        function changeSlide(direction) {
            const slides = document.querySelectorAll('.hero-slide');
            if (!slides.length) return;
            slides[currentSlide]?.classList.remove('active');
            currentSlide = (currentSlide + direction + slideCount) % slideCount;
            slides[currentSlide]?.classList.add('active');
        }

        /* âœ… 4. æ‰‹æ©Ÿæ»‘å‹•æ‰‹å‹¢ */
        function bindTouchSwipe() {
            const hero = document.getElementById('heroSection');
            hero.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].clientX; }, {passive:true});
            hero.addEventListener('touchend', (e) => {
                touchEndX = e.changedTouches[0].clientX;
                const dx = touchEndX - touchStartX;
                if (Math.abs(dx) > 40 && slideCount > 1) {
                    changeSlide(dx > 0 ? -1 : 1);
                    startSlideShow(); // é‡ç½®è‡ªå‹•è¼ªæ’­è¨ˆæ™‚
                }
            }, {passive:true});
        }

        function displayMap(exp) {
            const mapSection = document.getElementById('mapSection');
            if (!exp['Google Maps åµŒå…¥é€£çµ'] && !exp['åœ°å€']) {
                mapSection.style.display = 'none';
                return;
            }
            let mapHTML = '<h2>ğŸ“ ä½ç½®è³‡è¨Š Location</h2>';
            if (exp['åœ°å€']) mapHTML += `<div class="map-address">ğŸ“ ${exp['åœ°å€']}</div>`;
            if (exp['Google Maps åµŒå…¥é€£çµ']) {
                mapHTML += `
                    <div class="map-container">
                        <iframe src="${exp['Google Maps åµŒå…¥é€£çµ']}" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                    </div>
                `;
            }
            mapSection.innerHTML = mapHTML;
        }

        function formatContent(content) {
            if (!content) return '<p>æº–å‚™ä¸­...</p>';
            const paragraphs = content.split('\n').filter(p => p.trim());
            return paragraphs.map(p => `<p>${p}</p>`).join('');
        }

        window.addEventListener('scroll', () => {
            const backToTop = document.querySelector('.back-to-top');
            if (window.pageYOffset > 300) backToTop.classList.add('show');
            else backToTop.classList.remove('show');
        });

        function scrollToTop(){ window.scrollTo({ top:0, behavior:'smooth' }); }

        window.addEventListener('DOMContentLoaded', loadExperience);
    </script>
</body>
</html>
